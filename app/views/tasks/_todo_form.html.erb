<%= form_with model: @task, local: true do |f| %>
  <div class="flex flex-col gap-4" data-controller="todo-form">
    <div class="flex items-center justify-between">
      <%= f.label :todos, class: "text-lg text-neutral font-semibold" %>
      <button type="button" 
              data-todo-form-target="addButton"
              data-action="click->todo-form#add"
              class="btn btn-neutral rounded-full shadow-none">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4">
          <path d="M8.75 3.75a.75.75 0 0 0-1.5 0v3.5h-3.5a.75.75 0 0 0 0 1.5h3.5v3.5a.75.75 0 0 0 1.5 0v-3.5h3.5a.75.75 0 0 0 0-1.5h-3.5v-3.5Z" />
        </svg>
        <span>追加</span>
      </button>
    </div>

    <!-- ToDoフィールド -->
    <div id="todos-container" data-todo-form-target="container" class="space-y-2">
      <%= f.fields_for :todos do |todo_form| %>
        <%= render "todo_field", todo_form: todo_form %>
      <% end %>
    </div>

    <!-- Stimulusコントローラーで使用する新規ToDoフィールド用テンプレート（ブラウザでは非表示） -->
    <template data-todo-form-target="template">
      <%= render "todo_field", todo_form: nil %>
    </template>

    <div class="flex justify-center">
      <%= f.submit "保存", class: "btn btn-lg btn-primary w-full text-base rounded-full shadow-none" %>
    </div>
  </div>
<% end %>
